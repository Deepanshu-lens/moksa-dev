import{i as p}from"./legacy.CS2Xrhg9.js";import{p as f,l as i,a as d,b as m}from"./effects.BhUQh3a6.js";import{s as u,a as v}from"./store.Cu8l1F6D.js";import{p as s}from"./pb.BjVtZEqq.js";import{s as _}from"./node.Bxisulq9.js";import"./ui.AXpcjr67.js";import{a as o,t as $}from"./all-events.CYEczPXl.js";import"./index.Syity6yz.js";function x(g,l){f(l,!1);const c=u(),t=()=>v(_,"$selectedNode",c),n=async()=>{try{s.autoCancellation(!1);const e=await s.collection("events").getList(1,10,{sort:"-created",filter:`node?="${t()}"`});o.set(e.items),$.set(e.totalItems)}catch(e){console.error("Error initializing Panel Manager:",e)}};i(()=>t(),()=>{t()&&n()}),i(()=>(t(),o),()=>{if(t())try{s.collection("events").subscribe("*",e=>{e.action==="create"?o.update(r=>[e.record,...r]):e.action==="update"&&o.update(r=>r.map(a=>a.id===e.record.id?e.record:a))},{filter:`node?="${t()}" && type!="face"`})}catch{console.error("Failed realtime events")}}),d(),p(),m()}export{x as default};
