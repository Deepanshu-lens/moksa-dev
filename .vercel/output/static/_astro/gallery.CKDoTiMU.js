import{i as f}from"./legacy.B9Y3TeRD.js";import{p,l as d,a as u,b as m}from"./effects.D69rIdB6.js";import{s as y,a as g}from"./store.LwFfO3GU.js";import{p as s}from"./pb.BjVtZEqq.js";import{u as G}from"./user.DTKNVqgd.js";import"./ui.BlnsDfWm.js";import{g as t,i,t as $}from"./gallery.D9X5bGz5.js";import"./index.PDEF5wc2.js";function E(_,l){p(l,!1);const c=y(),a=()=>g(G,"$user",c),n=async()=>{i.set(!0);try{const e=await s.collection("faceGallery").getFullList({filter:`session= "${a()?.session[0]}"`,sort:"-created"});t.set(e),$.set(e?.length||0)}catch(e){console.error("Error initializing Gallery Manager:",e)}finally{i.set(!1)}};d(()=>(a(),t),()=>{if(a()){n(),s.collection("faceGallery").unsubscribe("*");try{s.collection("faceGallery").subscribe("*",e=>{console.log("Camera collection updated!! ",e.action,e.record),e.action==="create"?t.update(r=>[...r,e.record]):e.action==="update"?t.update(r=>r.map(o=>o.id===e.record.id?e.record:o)):e.action==="delete"&&t.update(r=>r.filter(o=>o.id!==e.record.id))},{filter:`session.id?="${a()?.session[0]}"`})}catch{console.error("Failed realtime camera")}}}),u(),f(),m()}export{E as default};
